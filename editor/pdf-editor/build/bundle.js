var app=function(){"use strict";function t(){}const e=t=>t;function n(t){return t()}function o(){return Object.create(null)}function i(t){t.forEach(n)}function r(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let l;function a(t,e){return t!=t?e==e:t!==e}function c(t,e,n,o){if(t){const i=u(t,e,n,o);return t[0](i)}}function u(t,e,n,o){return t[1]&&o?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](o(e))):n.ctx}function d(t,e,n,o){if(t[2]&&o){const i=t[2](o(n));if(void 0===e.dirty)return i;if("object"==typeof i){const t=[],n=Math.max(e.dirty.length,i.length);for(let o=0;o<n;o+=1)t[o]=e.dirty[o]|i[o];return t}return e.dirty|i}return e.dirty}function f(t,e,n,o,i,r){if(i){const s=u(e,n,o,r);t.p(s,i)}}function h(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function p(e){return e&&r(e.destroy)?e.destroy:t}const m="undefined"!=typeof window;let g=m?()=>window.performance.now():()=>Date.now(),w=m?t=>requestAnimationFrame(t):t;const y=new Set;function x(t){y.forEach(e=>{e.c(t)||(y.delete(e),e.f())}),0!==y.size&&w(x)}function v(t,e){t.appendChild(e)}function b(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function $(t){const e=E("style");return function(t,e){v(t.head||t,e)}(b(t),e),e.sheet}function L(t,e,n){t.insertBefore(e,n||null)}function k(t){t.parentNode.removeChild(t)}function E(t){return document.createElement(t)}function z(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function j(t){return document.createTextNode(t)}function S(){return j(" ")}function H(){return j("")}function C(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function M(t){return function(e){return e.preventDefault(),t.call(this,e)}}function F(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function T(t){return""===t?null:+t}function _(t,e){t.value=null==e?"":e}function P(t,e,n,o){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}function D(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}t.selectedIndex=-1}function R(t,e,n){t.classList[n?"add":"remove"](e)}function A(t,e,n=!1){const o=document.createEvent("CustomEvent");return o.initCustomEvent(t,n,!1,e),o}const N=new Map;let W,q=0;function B(t,e,n,o,i,r,s,l=0){const a=16.666/o;let c="{\n";for(let t=0;t<=1;t+=a){const o=e+(n-e)*r(t);c+=100*t+`%{${s(o,1-o)}}\n`}const u=c+`100% {${s(n,1-n)}}\n}`,d=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(u)}_${l}`,f=b(t),{stylesheet:h,rules:p}=N.get(f)||function(t,e){const n={stylesheet:$(e),rules:{}};return N.set(t,n),n}(f,t);p[d]||(p[d]=!0,h.insertRule(`@keyframes ${d} ${u}`,h.cssRules.length));const m=t.style.animation||"";return t.style.animation=`${m?m+", ":""}${d} ${o}ms linear ${i}ms 1 both`,q+=1,d}function O(t,e){const n=(t.style.animation||"").split(", "),o=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=n.length-o.length;i&&(t.style.animation=o.join(", "),q-=i,q||w(()=>{q||(N.forEach(t=>{const{stylesheet:e}=t;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.rules={}}),N.clear())}))}function X(t){W=t}function Y(){if(!W)throw new Error("Function called outside component initialization");return W}function U(t){Y().$$.on_mount.push(t)}function I(){const t=Y();return(e,n)=>{const o=t.$$.callbacks[e];if(o){const i=A(e,n);o.slice().forEach(e=>{e.call(t,i)})}}}function J(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(t=>t.call(this,e))}const G=[],K=[],V=[],Q=[],Z=Promise.resolve();let tt=!1;function et(t){V.push(t)}const nt=new Set;let ot,it=0;function rt(){const t=W;do{for(;it<G.length;){const t=G[it];it++,X(t),st(t.$$)}for(X(null),G.length=0,it=0;K.length;)K.pop()();for(let t=0;t<V.length;t+=1){const e=V[t];nt.has(e)||(nt.add(e),e())}V.length=0}while(G.length);for(;Q.length;)Q.pop()();tt=!1,nt.clear(),X(t)}function st(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(et)}}function lt(t,e,n){t.dispatchEvent(A(`${e?"intro":"outro"}${n}`))}const at=new Set;let ct;function ut(){ct={r:0,c:[],p:ct}}function dt(){ct.r||i(ct.c),ct=ct.p}function ft(t,e){t&&t.i&&(at.delete(t),t.i(e))}function ht(t,e,n,o){if(t&&t.o){if(at.has(t))return;at.add(t),ct.c.push(()=>{at.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}}const pt={duration:0};function mt(n,o,s,l){let a=o(n,s),c=l?0:1,u=null,d=null,f=null;function h(){f&&O(n,f)}function p(t,e){const n=t.b-c;return e*=Math.abs(n),{a:c,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function m(o){const{delay:r=0,duration:s=300,easing:l=e,tick:m=t,css:v}=a||pt,b={start:g()+r,b:o};o||(b.group=ct,ct.r+=1),u||d?d=b:(v&&(h(),f=B(n,c,o,s,r,l,v)),o&&m(0,1),u=p(b,s),et(()=>lt(n,o,"start")),function(t){let e;0===y.size&&w(x),new Promise(n=>{y.add(e={c:t,f:n})})}(t=>{if(d&&t>d.start&&(u=p(d,s),d=null,lt(n,u.b,"start"),v&&(h(),f=B(n,c,u.b,u.duration,0,l,a.css))),u)if(t>=u.end)m(c=u.b,1-c),lt(n,u.b,"end"),d||(u.b?h():--u.group.r||i(u.group.c)),u=null;else if(t>=u.start){const e=t-u.start;c=u.a+u.d*l(e/u.duration),m(c,1-c)}return!(!u&&!d)}))}return{run(t){r(a)?(ot||(ot=Promise.resolve(),ot.then(()=>{ot=null})),ot).then(()=>{a=a(),m(t)}):m(t)},end(){h(),u=d=null}}}const gt="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function wt(t,e){ht(t,1,1,()=>{e.delete(t.key)})}function yt(t,e,n,o,i,r,s,l,a,c,u,d){let f=t.length,h=r.length,p=f;const m={};for(;p--;)m[t[p].key]=p;const g=[],w=new Map,y=new Map;for(p=h;p--;){const t=d(i,r,p),l=n(t);let a=s.get(l);a?o&&a.p(t,e):(a=c(l,t),a.c()),w.set(l,g[p]=a),l in m&&y.set(l,Math.abs(p-m[l]))}const x=new Set,v=new Set;function b(t){ft(t,1),t.m(l,u),s.set(t.key,t),u=t.first,h--}for(;f&&h;){const e=g[h-1],n=t[f-1],o=e.key,i=n.key;e===n?(u=e.first,f--,h--):w.has(i)?!s.has(o)||x.has(o)?b(e):v.has(i)?f--:y.get(o)>y.get(i)?(v.add(o),b(e)):(x.add(i),f--):(a(n,s),f--)}for(;f--;){const e=t[f];w.has(e.key)||a(e,s)}for(;h;)b(g[h-1]);return g}function xt(t){t&&t.c()}function vt(t,e,o,s){const{fragment:l,on_mount:a,on_destroy:c,after_update:u}=t.$$;l&&l.m(e,o),s||et(()=>{const e=a.map(n).filter(r);c?c.push(...e):i(e),t.$$.on_mount=[]}),u.forEach(et)}function bt(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function $t(t,e){-1===t.$$.dirty[0]&&(G.push(t),tt||(tt=!0,Z.then(rt)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Lt(e,n,r,s,l,a,c,u=[-1]){const d=W;X(e);const f=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:l,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:o(),dirty:u,skip_bound:!1,root:n.target||d.$$.root};c&&c(f.root);let h=!1;if(f.ctx=r?r(e,n.props||{},(t,n,...o)=>{const i=o.length?o[0]:n;return f.ctx&&l(f.ctx[t],f.ctx[t]=i)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](i),h&&$t(e,t)),n}):[],f.update(),h=!0,i(f.before_update),f.fragment=!!s&&s(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(k)}else f.fragment&&f.fragment.c();n.intro&&ft(e.$$.fragment),vt(e,n.target,n.anchor,n.customElement),rt()}X(d)}class kt{$destroy(){bt(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Et(t){const e=t-1;return e*e*e+1}function zt(t,{delay:e=0,duration:n=400,easing:o=Et,x:i=0,y:r=0,opacity:s=0}={}){const l=getComputedStyle(t),a=+l.opacity,c="none"===l.transform?"":l.transform,u=a*(1-s);return{delay:e,duration:n,easing:o,css:(t,e)=>`\n\t\t\ttransform: ${c} translate(${(1-t)*i}px, ${(1-t)*r}px);\n\t\t\topacity: ${a-u*e}`}}class jt extends kt{constructor(t){super(),Lt(this,t,null,null,s,{})}}function St(e){let n,o;return{c(){n=E("div"),o=E("canvas"),F(o,"class","max-w-full"),P(o,"width",e[1]+"px"),F(o,"width",e[1]),F(o,"height",e[2])},m(t,i){L(t,n,i),v(n,o),e[4](o)},p(t,[e]){2&e&&P(o,"width",t[1]+"px"),2&e&&F(o,"width",t[1]),4&e&&F(o,"height",t[2])},i:t,o:t,d(t){t&&k(n),e[4](null)}}}function Ht(t,e,n){let{page:o}=e;const i=I();let r,s,l;function a(){i("measure",{scale:r.clientWidth/s})}var c;return U((async function(){const t=await o,e=r.getContext("2d"),i=t.getViewport({scale:1,rotation:0});n(1,s=i.width),n(2,l=i.height),await t.render({canvasContext:e,viewport:i}).promise,a(),window.addEventListener("resize",a)})),c=()=>{window.removeEventListener("resize",a)},Y().$$.on_destroy.push(c),t.$$set=t=>{"page"in t&&n(3,o=t.page)},[r,s,l,o,function(t){K[t?"unshift":"push"](()=>{r=t,n(0,r)})}]}class Ct extends kt{constructor(t){super(),Lt(this,t,Ht,St,s,{page:3})}}function Mt(t){let e,n;function o(o){e=o.clientX,n=o.clientY;const s=o.target;t.dispatchEvent(new CustomEvent("panstart",{detail:{x:e,y:n,target:s}})),window.addEventListener("mousemove",i),window.addEventListener("mouseup",r)}function i(o){const i=o.clientX-e,r=o.clientY-n;e=o.clientX,n=o.clientY,t.dispatchEvent(new CustomEvent("panmove",{detail:{x:e,y:n,dx:i,dy:r}}))}function r(o){e=o.clientX,n=o.clientY,t.dispatchEvent(new CustomEvent("panend",{detail:{x:e,y:n}})),window.removeEventListener("mousemove",i),window.removeEventListener("mouseup",r)}function s(o){if(o.touches.length>1)return;const i=o.touches[0];e=i.clientX,n=i.clientY;const r=i.target;t.dispatchEvent(new CustomEvent("panstart",{detail:{x:e,y:n,target:r}})),window.addEventListener("touchmove",l,{passive:!1}),window.addEventListener("touchend",a)}function l(o){if(o.preventDefault(),o.touches.length>1)return;const i=o.touches[0],r=i.clientX-e,s=i.clientY-n;e=i.clientX,n=i.clientY,t.dispatchEvent(new CustomEvent("panmove",{detail:{x:e,y:n,dx:r,dy:s}}))}function a(o){const i=o.changedTouches[0];e=i.clientX,n=i.clientY,t.dispatchEvent(new CustomEvent("panend",{detail:{x:e,y:n}})),window.removeEventListener("touchmove",l),window.removeEventListener("touchend",a)}return t.addEventListener("mousedown",o),t.addEventListener("touchstart",s),{destroy(){t.removeEventListener("mousedown",o),t.removeEventListener("touchstart",s)}}}function Ft(e){let n,o,r,s,l,a,c,u,d;return{c(){n=E("div"),o=E("div"),o.innerHTML='<div data-direction="left" class="resize-border h-full w-1 left-0 top-0 border-l cursor-ew-resize svelte-i6z4ik"></div> \n    <div data-direction="top" class="resize-border w-full h-1 left-0 top-0 border-t cursor-ns-resize svelte-i6z4ik"></div> \n    <div data-direction="bottom" class="resize-border w-full h-1 left-0 bottom-0 cursor-ns-resize svelte-i6z4ik"></div> \n    <div data-direction="right" class="resize-border h-full w-1 right-0 top-0 border-r cursor-ew-resize svelte-i6z4ik"></div> \n    <div data-direction="left-top" class="resize-corner left-0 top-0 cursor-nwse-resize transform -translate-x-1/2 -translate-y-1/2 md:scale-25 svelte-i6z4ik"></div> \n    <div data-direction="right-top" class="resize-corner right-0 top-0 cursor-nesw-resize transform translate-x-1/2 -translate-y-1/2 md:scale-25 svelte-i6z4ik"></div> \n    <div data-direction="left-bottom" class="resize-corner left-0 bottom-0 cursor-nesw-resize transform -translate-x-1/2 translate-y-1/2 md:scale-25 svelte-i6z4ik"></div> \n    <div data-direction="right-bottom" class="resize-corner right-0 bottom-0 cursor-nwse-resize transform translate-x-1/2 translate-y-1/2 md:scale-25 svelte-i6z4ik"></div>',s=S(),l=E("div"),l.innerHTML='<img class="w-full h-full" src="./delete-icon.svg" alt="delete object"/>',a=S(),c=E("canvas"),F(o,"class","absolute w-full h-full cursor-grab svelte-i6z4ik"),R(o,"cursor-grabbing","move"===e[5]),R(o,"operation",e[5]),F(l,"class","absolute left-0 top-0 right-0 w-12 h-12 m-auto rounded-full bg-white cursor-pointer transform -translate-y-1/2 md:scale-25"),F(c,"class","w-full h-full"),F(n,"class","absolute left-0 top-0 select-none"),P(n,"width",e[0]+e[8]+"px"),P(n,"height",e[1]+e[9]+"px"),P(n,"transform","translate("+(e[2]+e[6])+"px, "+(e[3]+e[7])+"px)")},m(t,i){L(t,n,i),v(n,o),v(n,s),v(n,l),v(n,a),v(n,c),e[17](c),u||(d=[p(r=Mt.call(null,o)),C(o,"panstart",e[12]),C(o,"panmove",e[10]),C(o,"panend",e[11]),C(l,"click",e[13])],u=!0)},p(t,[e]){32&e&&R(o,"cursor-grabbing","move"===t[5]),32&e&&R(o,"operation",t[5]),257&e&&P(n,"width",t[0]+t[8]+"px"),514&e&&P(n,"height",t[1]+t[9]+"px"),204&e&&P(n,"transform","translate("+(t[2]+t[6])+"px, "+(t[3]+t[7])+"px)")},i:t,o:t,d(t){t&&k(n),e[17](null),u=!1,i(d)}}}function Tt(t,e,n){let{payload:o}=e,{file:i}=e,{width:r}=e,{height:s}=e,{x:l}=e,{y:a}=e,{pageScale:c=1}=e;const u=I();let d,f,h,p="",m=[],g=0,w=0,y=0,x=0;return U((async function(){n(4,h.width=r,h),n(4,h.height=s,h),h.getContext("2d").drawImage(o,0,0);let t=1;r>500&&(t=500/r),s>500&&(t=Math.min(t,500/s)),u("update",{width:r*t,height:s*t}),["image/jpeg","image/png"].includes(i.type)||h.toBlob(t=>{u("update",{file:t})})})),t.$$set=t=>{"payload"in t&&n(14,o=t.payload),"file"in t&&n(15,i=t.file),"width"in t&&n(0,r=t.width),"height"in t&&n(1,s=t.height),"x"in t&&n(2,l=t.x),"y"in t&&n(3,a=t.y),"pageScale"in t&&n(16,c=t.pageScale)},[r,s,l,a,h,p,g,w,y,x,function(t){const e=(t.detail.x-d)/c,o=(t.detail.y-f)/c;"move"===p?(n(6,g=e),n(7,w=o)):"scale"===p&&(m.includes("left")&&(n(6,g=e),n(8,y=-e)),m.includes("top")&&(n(7,w=o),n(9,x=-o)),m.includes("right")&&n(8,y=e),m.includes("bottom")&&n(9,x=o))},function(t){"move"===p?(u("update",{x:l+g,y:a+w}),n(6,g=0),n(7,w=0)):"scale"===p&&(u("update",{x:l+g,y:a+w,width:r+y,height:s+x}),n(6,g=0),n(7,w=0),n(8,y=0),n(9,x=0),m=[]),n(5,p="")},function(t){if(d=t.detail.x,f=t.detail.y,t.detail.target===t.currentTarget)return n(5,p="move");n(5,p="scale"),m=t.detail.target.dataset.direction.split("-")},function(){u("delete")},o,i,c,function(t){K[t?"unshift":"push"](()=>{h=t,n(4,h)})}]}class _t extends kt{constructor(t){super(),Lt(this,t,Tt,Ft,a,{payload:14,file:15,width:0,height:1,x:2,y:3,pageScale:16})}}function Pt(t){let e,n;const o=t[2].default,i=c(o,t,t[1],null);return{c(){e=E("div"),i&&i.c()},m(o,r){L(o,e,r),i&&i.m(e,null),t[3](e),n=!0},p(t,[e]){i&&i.p&&(!n||2&e)&&f(i,o,t,t[1],n?d(o,t[1],e,null):h(t[1]),null)},i(t){n||(ft(i,t),n=!0)},o(t){ht(i,t),n=!1},d(n){n&&k(e),i&&i.d(n),t[3](null)}}}function Dt(t,e,n){let o,{$$slots:i={},$$scope:r}=e;return t.$$set=t=>{"$$scope"in t&&n(1,r=t.$$scope)},t.$$.update=()=>{1&t.$$.dirty&&o&&document.body.appendChild(o)},[o,r,i,function(t){K[t?"unshift":"push"](()=>{o=t,n(0,o)})}]}class Rt extends kt{constructor(t){super(),Lt(this,t,Dt,Pt,s,{})}}function At(t){let e,n;const o=t[0].default,i=c(o,t,t[1],null);return{c(){e=E("div"),i&&i.c(),F(e,"class","fixed z-10 bottom-0 left-0 right-0 h-12 mb-4")},m(t,o){L(t,e,o),i&&i.m(e,null),n=!0},p(t,e){i&&i.p&&(!n||2&e)&&f(i,o,t,t[1],n?d(o,t[1],e,null):h(t[1]),null)},i(t){n||(ft(i,t),n=!0)},o(t){ht(i,t),n=!1},d(t){t&&k(e),i&&i.d(t)}}}function Nt(t){let e,n;return e=new Rt({props:{$$slots:{default:[At]},$$scope:{ctx:t}}}),{c(){xt(e.$$.fragment)},m(t,o){vt(e,t,o),n=!0},p(t,[n]){const o={};2&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function Wt(t,e,n){let{$$slots:o={},$$scope:i}=e;return t.$$set=t=>{"$$scope"in t&&n(1,i=t.$$scope)},[o,i]}class qt extends kt{constructor(t){super(),Lt(this,t,Wt,Nt,s,{})}}function Bt(t){function e(e){Array.from(e.touches).some(e=>t.contains(e.target))||t.dispatchEvent(new CustomEvent("tapout"))}function n(e){t.contains(e.target)||t.dispatchEvent(new CustomEvent("tapout"))}return window.addEventListener("touchstart",e),window.addEventListener("mousedown",n),{destroy(){window.removeEventListener("touchstart",e),window.removeEventListener("mousedown",n)}}}const Ot=()=>{},Xt=[{name:"pdfjsLib",src:"https://unpkg.com/pdfjs-dist@2.3.200/build/pdf.min.js"},{name:"PDFLib",src:"https://unpkg.com/pdf-lib@1.4.0/dist/pdf-lib.min.js"},{name:"download",src:"https://unpkg.com/downloadjs@1.4.7"},{name:"makeTextPDF",src:"makeTextPDF.js"}],Yt={};function Ut(t){if(Yt[t])return Yt[t];const e=Xt.find(e=>e.name===t);if(!e)throw new Error(`Script ${t} not exists.`);return It(e)}function It({name:t,src:e}){return Yt[t]||(Yt[t]=new Promise((n,o)=>{const i=document.createElement("script");i.src=e,i.onload=()=>{n(window[t])},i.onerror=()=>{o(`The script ${t} didn't load correctly.`),alert("Some scripts did not load correctly. Please reload and try again.")},document.body.appendChild(i)})),Yt[t]}const Jt={Courier:{correction:(t,e)=>(t*e-t)/2+t/6},Helvetica:{correction:(t,e)=>(t*e-t)/2+t/10},"Times-Roman":{correction:(t,e)=>(t*e-t)/2+t/7}},Gt={...Jt,"標楷體":{src:"CK.ttf",correction:(t,e)=>(t*e-t)/2}};function Kt(t){if(Jt[t])return Jt[t];const e=Gt[t];if(!e)throw new Error(`Font '${t}' not exists.`);return Jt[t]=fetch(e.src).then(t=>t.arrayBuffer()).then(n=>{const o=new FontFace(t,n);return o.display="swap",o.load().then(()=>document.fonts.add(o)),{...e,buffer:n}}),Jt[t]}function Vt(t,e,n){const o=t.slice();return o[36]=e[n],o}function Qt(t){let e,n;return e=new qt({props:{$$slots:{default:[te]},$$scope:{ctx:t}}}),{c(){xt(e.$$.fragment)},m(t,o){vt(e,t,o),n=!0},p(t,n){const o={};24&n[0]|256&n[1]&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function Zt(e){let n,o,i,r=e[36]+"";return{c(){n=E("option"),o=j(r),n.__value=i=e[36],n.value=n.__value},m(t,e){L(t,n,e),v(n,o)},p:t,d(t){t&&k(n)}}}function te(t){let e,n,o,r,s,l,a,c,u,d,f,h,m,g,w=t[8],y=[];for(let e=0;e<w.length;e+=1)y[e]=Zt(Vt(t,w,e));return{c(){e=E("div"),n=E("div"),o=E("div"),r=E("select");for(let t=0;t<y.length;t+=1)y[t].c();s=S(),l=E("div"),a=S(),c=E("div"),u=E("input"),d=S(),f=E("div"),f.innerHTML='<img class="w-full h-full" src="./delete-icon.svg" alt="delete object"/>',F(r,"class","bg-white w-full h-full outline-none"),void 0===t[4]&&et(()=>t[26].call(r)),F(l,"class","pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"),F(o,"class","w-full h-full"),F(n,"class","w-56 mr-2 flex items-center border border-black"),F(u,"type","number"),F(u,"min","12"),F(u,"max","120"),F(u,"step","1"),F(u,"class","h-full w-full text-center flex-shrink-0 rounded-sm"),F(c,"class","mr-2 flex items-center w-16 border border-black h-8"),F(f,"class","w-5 h-5 rounded-full bg-white cursor-pointer"),F(e,"class","h-full flex justify-around items-center bg-white")},m(i,w){L(i,e,w),v(e,n),v(n,o),v(o,r);for(let t=0;t<y.length;t+=1)y[t].m(r,null);D(r,t[4]),v(o,s),v(o,l),v(e,a),v(e,c),v(c,u),_(u,t[3]),v(e,d),v(e,f),m||(g=[C(r,"change",t[26]),C(r,"change",t[19]),C(u,"input",t[27]),C(f,"click",t[20]),p(h=Bt.call(null,e)),C(e,"tapout",t[18]),C(e,"mousedown",t[17]),C(e,"touchstart",t[17],{passive:!0})],m=!0)},p(t,e){if(256&e[0]){let n;for(w=t[8],n=0;n<w.length;n+=1){const o=Vt(t,w,n);y[n]?y[n].p(o,e):(y[n]=Zt(o),y[n].c(),y[n].m(r,null))}for(;n<y.length;n+=1)y[n].d(1);y.length=w.length}272&e[0]&&D(r,t[4]),8&e[0]&&T(u.value)!==t[3]&&_(u,t[3])},d(t){t&&k(e),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(y,t),m=!1,i(g)}}}function ee(t){let e,n,o,r,s,l,a,c,u,d,f=t[7]&&"move"!==t[7]&&Qt(t);return{c(){f&&f.c(),e=S(),n=E("div"),o=E("div"),s=S(),l=E("div"),F(o,"class","absolute w-full h-full cursor-grab border border-black border-gray-500 svelte-istdr"),R(o,"cursor-grab",!t[7]),R(o,"cursor-grabbing","move"===t[7]),R(o,"editing",["edit","tool"].includes(t[7])),F(l,"contenteditable","true"),F(l,"spellcheck","false"),F(l,"class","outline-none whitespace-no-wrap"),P(l,"font-size",t[3]+"px"),P(l,"font-family","'"+t[4]+"', serif"),P(l,"line-height",t[9]),P(l,"-webkit-user-select","text"),F(n,"class","absolute left-0 top-0 select-none"),P(n,"transform","translate("+(t[0]+t[5])+"px, "+(t[1]+t[6])+"px)")},m(i,h){f&&f.m(i,h),L(i,e,h),L(i,n,h),v(n,o),v(n,s),v(n,l),t[28](l),c=!0,u||(d=[p(r=Mt.call(null,o)),C(o,"panstart",t[12]),C(o,"panmove",t[10]),C(o,"panend",t[11]),C(l,"focus",t[13]),C(l,"keydown",t[16]),C(l,"paste",M(t[15])),p(a=Bt.call(null,n)),C(n,"tapout",t[14])],u=!0)},p(t,i){t[7]&&"move"!==t[7]?f?(f.p(t,i),128&i[0]&&ft(f,1)):(f=Qt(t),f.c(),ft(f,1),f.m(e.parentNode,e)):f&&(ut(),ht(f,1,1,()=>{f=null}),dt()),128&i[0]&&R(o,"cursor-grab",!t[7]),128&i[0]&&R(o,"cursor-grabbing","move"===t[7]),128&i[0]&&R(o,"editing",["edit","tool"].includes(t[7])),(!c||8&i[0])&&P(l,"font-size",t[3]+"px"),(!c||16&i[0])&&P(l,"font-family","'"+t[4]+"', serif"),(!c||99&i[0])&&P(n,"transform","translate("+(t[0]+t[5])+"px, "+(t[1]+t[6])+"px)")},i(t){c||(ft(f),c=!0)},o(t){ht(f),c=!1},d(o){f&&f.d(o),o&&k(e),o&&k(n),t[28](null),u=!1,i(d)}}}function ne(t,e,n){let{size:o}=e,{text:i}=e,{lineHeight:r}=e,{x:s}=e,{y:l}=e,{fontFamily:a}=e,{pageScale:c=1}=e;const u=Object.keys(Gt),d=I();let f,h,p,m=o,g=r,w=a,y=0,x=0,v="";function b(){let t;for(;t=Array.from(p.childNodes).find(t=>!["#text","BR"].includes(t.nodeName));)p.removeChild(t)}function $(){const t=p.childNodes,e=[];let n="";for(let o=0;o<t.length;o++){const i=t[o];"BR"===i.nodeName?(e.push(n),n=""):n+=i.textContent}return e.push(n),e}function L(){const t=document.querySelector(".toolbar"),e=document.querySelector(".hide"),n=document.querySelector(".tools");("tool"!==v||(d("delete"),t.classList.contains("toolbar--expand")))&&(""==v&&t.classList.contains("toolbar--expand")?(t.classList.remove("toolbar--expand"),e.classList.add("hidden"),n.classList.remove("justify-around"),n.classList.add("justify-center")):t.classList.contains("toolbar--expand")?(t.classList.remove("toolbar--expand"),e.classList.add("hidden"),n.classList.remove("justify-around"),n.classList.add("justify-center"),d("delete")):(t.classList.add("toolbar--expand"),e.classList.remove("hidden"),n.classList.add("justify-around"),n.classList.remove("justify-center")))}return U((function(){n(2,p.innerHTML=i,p),p.focus()})),t.$$set=t=>{"size"in t&&n(21,o=t.size),"text"in t&&n(22,i=t.text),"lineHeight"in t&&n(23,r=t.lineHeight),"x"in t&&n(0,s=t.x),"y"in t&&n(1,l=t.y),"fontFamily"in t&&n(24,a=t.fontFamily),"pageScale"in t&&n(25,c=t.pageScale)},[s,l,p,m,w,y,x,v,u,g,function(t){n(5,y=(t.detail.x-f)/c),n(6,x=(t.detail.y-h)/c)},function(t){if(0===y&&0===x)return p.focus();d("update",{x:s+y,y:l+x}),n(5,y=0),n(6,x=0),n(7,v="")},function(t){f=t.detail.x,h=t.detail.y,n(7,v="move")},function(){n(7,v="edit"),document.querySelector(".toolbar").classList.contains("toolbar--expand")||L()},async function(){if("edit"!==v||"tool"===v)return;p.blur(),b(),d("update",{lines:$(),width:p.clientWidth}),n(7,v=""),document.querySelector(".toolbar").classList.contains("toolbar--expand")&&L()},async function(t){const e=t.clipboardData.getData("text");var n;document.execCommand("insertHTML",!1,e),await new Promise(t=>setTimeout(t,n)),b()},function(t){const e=Array.from(p.childNodes);if(13===t.keyCode){t.preventDefault();const n=window.getSelection(),o=n.focusNode,i=n.focusOffset;if(o===p)p.insertBefore(document.createElement("br"),e[i]);else if(o instanceof HTMLBRElement)p.insertBefore(document.createElement("br"),o);else if(o.textContent.length!==i)document.execCommand("insertHTML",!1,"<br>");else{let t=o.nextSibling;t?p.insertBefore(document.createElement("br"),t):(t=p.appendChild(document.createElement("br")),t=p.appendChild(document.createElement("br"))),n.collapse(t,0)}}},function(){n(7,v="tool")},async function(){if("tool"!==v||"edit"===v)return;d("update",{lines:$(),lineHeight:g,size:m,fontFamily:w}),n(7,v=""),document.querySelector(".toolbar").classList.contains("toolbar--expand")&&L()},function(){d("selectFont",{name:w})},function(){L()},o,i,r,a,c,function(){w=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),n(4,w),n(8,u)},function(){m=T(this.value),n(3,m)},function(t){K[t?"unshift":"push"](()=>{p=t,n(2,p)})}]}class oe extends kt{constructor(t){super(),Lt(this,t,ne,ee,a,{size:21,text:22,lineHeight:23,x:0,y:1,fontFamily:24,pageScale:25},null,[-1,-1])}}function ie(e){let n,o,r,s,l,a,c,u,d,f;return{c(){n=E("div"),o=E("div"),o.innerHTML='<div data-direction="left-top" class="absolute left-0 top-0 w-10 h-10 bg-green-400 rounded-full cursor-nwse-resize transform -translate-x-1/2 -translate-y-1/2 md:scale-25"></div> \n    <div data-direction="right-bottom" class="absolute right-0 bottom-0 w-10 h-10 bg-green-400 rounded-full cursor-nwse-resize transform translate-x-1/2 translate-y-1/2 md:scale-25"></div>',s=S(),l=E("div"),l.innerHTML='<img class="w-full h-full" src="./delete-icon.svg" alt="delete object"/>',a=S(),c=z("svg"),u=z("path"),F(o,"class","absolute w-full h-full cursor-grab svelte-sf1zqb"),R(o,"cursor-grabbing","move"===e[5]),R(o,"operation",e[5]),F(l,"class","absolute left-0 top-0 right-0 w-12 h-12 m-auto rounded-full bg-white cursor-pointer transform -translate-y-1/2 md:scale-25"),F(u,"stroke-width","5"),F(u,"stroke-linejoin","round"),F(u,"stroke-linecap","round"),F(u,"stroke","black"),F(u,"fill","none"),F(u,"d",e[3]),F(c,"width","100%"),F(c,"height","100%"),F(n,"class","absolute left-0 top-0 select-none"),P(n,"width",e[0]+e[8]+"px"),P(n,"height",(e[0]+e[8])/e[9]+"px"),P(n,"transform","translate("+(e[1]+e[6])+"px, "+(e[2]+e[7])+"px)")},m(t,i){L(t,n,i),v(n,o),v(n,s),v(n,l),v(n,a),v(n,c),v(c,u),e[17](c),d||(f=[p(r=Mt.call(null,o)),C(o,"panstart",e[12]),C(o,"panmove",e[10]),C(o,"panend",e[11]),C(l,"click",e[13])],d=!0)},p(t,[e]){32&e&&R(o,"cursor-grabbing","move"===t[5]),32&e&&R(o,"operation",t[5]),8&e&&F(u,"d",t[3]),257&e&&P(n,"width",t[0]+t[8]+"px"),257&e&&P(n,"height",(t[0]+t[8])/t[9]+"px"),198&e&&P(n,"transform","translate("+(t[1]+t[6])+"px, "+(t[2]+t[7])+"px)")},i:t,o:t,d(t){t&&k(n),e[17](null),d=!1,i(f)}}}function re(t,e,n){let{originWidth:o}=e,{originHeight:i}=e,{width:r}=e,{x:s}=e,{y:l}=e,{pageScale:a=1}=e,{path:c}=e;const u=I();let d,f,h,p="",m=0,g=0,w=0,y="";const x=o/i;return U((async function(){h.setAttribute("viewBox",`0 0 ${o} ${i}`)})),t.$$set=t=>{"originWidth"in t&&n(14,o=t.originWidth),"originHeight"in t&&n(15,i=t.originHeight),"width"in t&&n(0,r=t.width),"x"in t&&n(1,s=t.x),"y"in t&&n(2,l=t.y),"pageScale"in t&&n(16,a=t.pageScale),"path"in t&&n(3,c=t.path)},[r,s,l,c,h,p,m,g,w,x,function(t){const e=(t.detail.x-d)/a,o=(t.detail.y-f)/a;if("move"===p)n(6,m=e),n(7,g=o);else if("scale"===p){if("left-top"===y){let t=1/0;t=Math.min(e,o*x),n(6,m=t),n(8,w=-t),n(7,g=t/x)}if("right-bottom"===y){let t=-1/0;t=Math.max(e,o*x),n(8,w=t)}}},function(t){"move"===p?(u("update",{x:s+m,y:l+g}),n(6,m=0),n(7,g=0)):"scale"===p&&(u("update",{x:s+m,y:l+g,width:r+w,scale:(r+w)/o}),n(6,m=0),n(7,g=0),n(8,w=0),y=""),n(5,p="")},function(t){if(d=t.detail.x,f=t.detail.y,t.detail.target===t.currentTarget)return n(5,p="move");n(5,p="scale"),y=t.detail.target.dataset.direction},function(){u("delete")},o,i,a,function(t){K[t?"unshift":"push"](()=>{h=t,n(4,h)})}]}class se extends kt{constructor(t){super(),Lt(this,t,re,ie,a,{originWidth:14,originHeight:15,width:0,x:1,y:2,pageScale:16,path:3})}}function le(e){let n,o,r,s,l,a,c,u,d,f,h;return{c(){n=E("div"),o=E("div"),r=E("button"),r.textContent="Cancel",s=S(),l=E("button"),l.textContent="Done",a=S(),c=z("svg"),u=z("path"),F(r,"class","w-24 bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-4 rounded mr-4"),F(l,"class","w-24 bg-blue-600 hover:bg-blue-700 text-white font-bold py-1 px-4 rounded"),F(o,"class","absolute right-0 bottom-0 mr-4 mb-4 flex"),F(u,"stroke-width","5"),F(u,"stroke-linejoin","round"),F(u,"stroke-linecap","round"),F(u,"d",e[1]),F(u,"stroke","black"),F(u,"fill","none"),F(c,"class","w-full h-full pointer-events-none"),F(n,"class","relative w-full h-full select-none")},m(t,i){L(t,n,i),v(n,o),v(o,r),v(o,s),v(o,l),v(n,a),v(n,c),v(c,u),e[7](n),f||(h=[C(r,"click",e[6]),C(l,"click",e[5]),p(d=Mt.call(null,n)),C(n,"panstart",e[2]),C(n,"panmove",e[3]),C(n,"panend",e[4])],f=!0)},p(t,[e]){2&e&&F(u,"d",t[1])},i:t,o:t,d(t){t&&k(n),e[7](null),f=!1,i(h)}}}function ae(t,e,n){const o=I();let i,r=0,s=0,l="",a=1/0,c=0,u=1/0,d=0,f=[],h=!1;return[i,l,function(t){if(t.detail.target!==i)return h=!1;h=!0,r=t.detail.x,s=t.detail.y-25,a=Math.min(a,r),c=Math.max(c,r),u=Math.min(u,s),d=Math.max(d,s),f.push(["M",r,s]),n(1,l+=`M${r+2},${s+45}`)},function(t){h&&(r=t.detail.x,s=t.detail.y-25,a=Math.min(a,r),c=Math.max(c,r),u=Math.min(u,s),d=Math.max(d,s),f.push(["L",r,s]),n(1,l+=`L${r+2},${s+45}`))},function(){h=!1},function(){if(!f.length)return;const t=-(a-50),e=-(u-50);o("finish",{originWidth:c-a+50,originHeight:d-u+50,path:f.reduce((n,o)=>n+o[0]+(o[1]+t)+","+(o[2]+e),"")})},function(){o("cancel")},function(t){K[t?"unshift":"push"](()=>{i=t,n(0,i)})}]}class ce extends kt{constructor(t){super(),Lt(this,t,ae,le,s,{})}}function ue(t){return new Promise((e,n)=>{const o=new FileReader;o.onload=()=>e(o.result),o.onerror=n,o.readAsArrayBuffer(t)})}const{window:de}=gt;function fe(t,e,n){const o=t.slice();return o[40]=e[n],o[42]=n,o}function he(t,e,n){const o=t.slice();return o[43]=e[n],o}function pe(e){let n,o,i,r;return o=new ce({}),o.$on("finish",e[20]),o.$on("cancel",e[21]),{c(){n=E("div"),xt(o.$$.fragment),F(n,"class","hover-pencil fixed z-10 top-0 left-0 right-0 bg-white shadow-lg"),P(n,"height","50%")},m(t,e){L(t,n,e),vt(o,n,null),r=!0},p:t,i(t){r||(ft(o.$$.fragment,t),et(()=>{i||(i=mt(n,zt,{y:-200,duration:500},!0)),i.run(1)}),r=!0)},o(t){ht(o.$$.fragment,t),i||(i=mt(n,zt,{y:-200,duration:500},!1)),i.run(0),r=!1},d(t){t&&k(n),bt(o),t&&i&&i.end()}}}function me(e){let n;return{c(){n=E("div"),n.innerHTML='<span class="font-bold text-3xl text-gray-500">Drag something here</span>',F(n,"class","w-full flex-grow flex justify-center items-center")},m(t,e){L(t,n,e)},p:t,i:t,o:t,d(t){t&&k(n)}}}function ge(t){let e,n,o=[],i=new Map,r=t[1];const s=t=>t[40];for(let e=0;e<r.length;e+=1){let n=fe(t,r,e),l=s(n);i.set(l,o[e]=be(l,n))}return{c(){e=E("div");for(let t=0;t<o.length;t+=1)o[t].c();F(e,"class","w-full")},m(t,i){L(t,e,i);for(let t=0;t<o.length;t+=1)o[t].m(e,null);n=!0},p(t,n){31758&n[0]&&(r=t[1],ut(),o=yt(o,n,s,1,t,r,i,e,wt,be,null,fe),dt())},i(t){if(!n){for(let t=0;t<r.length;t+=1)ft(o[t]);n=!0}},o(t){for(let t=0;t<o.length;t+=1)ht(o[t]);n=!1},d(t){t&&k(e);for(let t=0;t<o.length;t+=1)o[t].d()}}}function we(t){let e,n;return e=new se({props:{path:t[43].path,x:t[43].x,y:t[43].y,width:t[43].width,originWidth:t[43].originWidth,originHeight:t[43].originHeight,pageScale:t[2][t[42]]}}),e.$on("update",(function(...e){return t[27](t[43],...e)})),e.$on("delete",(function(){return t[28](t[43])})),{c(){xt(e.$$.fragment)},m(t,o){vt(e,t,o),n=!0},p(n,o){t=n;const i={};10&o[0]&&(i.path=t[43].path),10&o[0]&&(i.x=t[43].x),10&o[0]&&(i.y=t[43].y),10&o[0]&&(i.width=t[43].width),10&o[0]&&(i.originWidth=t[43].originWidth),10&o[0]&&(i.originHeight=t[43].originHeight),6&o[0]&&(i.pageScale=t[2][t[42]]),e.$set(i)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function ye(t){let e,n;return e=new oe({props:{text:t[43].text,x:t[43].x,y:t[43].y,size:t[43].size,lineHeight:t[43].lineHeight,fontFamily:t[43].fontFamily,pageScale:t[2][t[42]]}}),e.$on("update",(function(...e){return t[25](t[43],...e)})),e.$on("delete",(function(){return t[26](t[43])})),e.$on("selectFont",t[10]),{c(){xt(e.$$.fragment)},m(t,o){vt(e,t,o),n=!0},p(n,o){t=n;const i={};10&o[0]&&(i.text=t[43].text),10&o[0]&&(i.x=t[43].x),10&o[0]&&(i.y=t[43].y),10&o[0]&&(i.size=t[43].size),10&o[0]&&(i.lineHeight=t[43].lineHeight),10&o[0]&&(i.fontFamily=t[43].fontFamily),6&o[0]&&(i.pageScale=t[2][t[42]]),e.$set(i)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function xe(t){let e,n;return e=new _t({props:{file:t[43].file,payload:t[43].payload,x:t[43].x,y:t[43].y,width:t[43].width,height:t[43].height,pageScale:t[2][t[42]]}}),e.$on("update",(function(...e){return t[23](t[43],...e)})),e.$on("delete",(function(){return t[24](t[43])})),{c(){xt(e.$$.fragment)},m(t,o){vt(e,t,o),n=!0},p(n,o){t=n;const i={};10&o[0]&&(i.file=t[43].file),10&o[0]&&(i.payload=t[43].payload),10&o[0]&&(i.x=t[43].x),10&o[0]&&(i.y=t[43].y),10&o[0]&&(i.width=t[43].width),10&o[0]&&(i.height=t[43].height),6&o[0]&&(i.pageScale=t[2][t[42]]),e.$set(i)},i(t){n||(ft(e.$$.fragment,t),n=!0)},o(t){ht(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function ve(t,e){let n,o,i,r,s;const l=[xe,ye,we],a=[];function c(t,e){return"image"===t[43].type?0:"text"===t[43].type?1:"drawing"===t[43].type?2:-1}return~(o=c(e))&&(i=a[o]=l[o](e)),{key:t,first:null,c(){n=H(),i&&i.c(),r=H(),this.first=n},m(t,e){L(t,n,e),~o&&a[o].m(t,e),L(t,r,e),s=!0},p(t,n){let s=o;o=c(e=t),o===s?~o&&a[o].p(e,n):(i&&(ut(),ht(a[s],1,1,()=>{a[s]=null}),dt()),~o?(i=a[o],i?i.p(e,n):(i=a[o]=l[o](e),i.c()),ft(i,1),i.m(r.parentNode,r)):i=null)},i(t){s||(ft(i),s=!0)},o(t){ht(i),s=!1},d(t){t&&k(n),~o&&a[o].d(t),t&&k(r)}}}function be(t,e){let n,o,r,s,l,a,c,u,d,f=[],h=new Map;r=new Ct({props:{page:e[40]}}),r.$on("measure",(function(...t){return e[22](e[42],...t)}));let p=e[3][e[42]];const m=t=>t[43].id;for(let t=0;t<p.length;t+=1){let n=he(e,p,t),o=m(n);h.set(o,f[t]=ve(o,n))}function g(){return e[29](e[42])}function w(){return e[30](e[42])}return{key:t,first:null,c(){n=E("div"),o=E("div"),xt(r.$$.fragment),s=S(),l=E("div");for(let t=0;t<f.length;t+=1)f[t].c();a=S(),F(l,"class","absolute top-0 left-0 transform origin-top-left"),P(l,"transform","scale("+e[2][e[42]]+")"),P(l,"touch-action","none"),F(o,"class","canvas relative"),F(n,"class","p-5 w-full flex flex-col items-center overflow-hidden"),this.first=n},m(t,e){L(t,n,e),v(n,o),vt(r,o,null),v(o,s),v(o,l);for(let t=0;t<f.length;t+=1)f[t].m(l,null);v(n,a),c=!0,u||(d=[C(n,"mousedown",g),C(n,"touchstart",w,{passive:!0})],u=!0)},p(t,n){e=t;const o={};2&n[0]&&(o.page=e[40]),r.$set(o),13326&n[0]&&(p=e[3][e[42]],ut(),f=yt(f,n,m,1,e,p,h,l,wt,ve,null,he),dt()),(!c||6&n[0])&&P(l,"transform","scale("+e[2][e[42]]+")")},i(t){if(!c){ft(r.$$.fragment,t);for(let t=0;t<p.length;t+=1)ft(f[t]);c=!0}},o(t){ht(r.$$.fragment,t);for(let t=0;t<f.length;t+=1)ht(f[t]);c=!1},d(t){t&&k(n),bt(r);for(let t=0;t<f.length;t+=1)f[t].d();u=!1,i(d)}}}function $e(t){let e,n,o,r,s,a,c,u,d,f,h,p,m,g,w,y,x,b,$,z,j,H,T,P,D,A,N,W,q,B,O,X,Y,U,I,J,G,K,V,Q,Z,tt,et,nt,ot,it,rt,st,lt;e=new jt({});let at=t[5]&&pe(t);const ct=[ge,me],pt=[];function mt(t,e){return t[1].length?0:1}return ot=mt(t),it=pt[ot]=ct[ot](t),{c(){var i,v;xt(e.$$.fragment),n=S(),o=E("main"),r=E("div"),s=E("div"),a=E("a"),a.innerHTML='<img src="./A1-logo.svg" alt="Logo" class="lg:w-10 lg:h-10 w-8 h-8 lg:ml-20"/>',c=S(),u=E("div"),d=E("input"),f=S(),h=E("img"),m=S(),g=E("div"),g.innerHTML='<p class="hidden button download cursor-pointer flex justify-center items-center text-white lg:flex lg:mr-10">Download</p> \n        <img src="./download-icon.svg" alt="download" class="lg:hidden w-5"/>',w=S(),y=E("div"),x=E("input"),b=S(),$=E("input"),z=S(),j=E("div"),H=E("hr"),T=S(),P=E("div"),D=E("div"),A=E("label"),A.innerHTML='<img src="./image-icon.svg" alt="Custom" class="lg:w-8"/>',N=S(),W=E("p"),W.textContent="Image",q=S(),B=E("div"),O=E("p"),O.innerHTML='<img src="./draw-icon.svg" alt="draw" class="lg:w-8"/>',X=S(),Y=E("p"),Y.textContent="Draw",U=S(),I=E("div"),J=E("label"),J.innerHTML='<img src="./add-text-icon.svg" alt="add text" class="lg:w-8"/>',G=S(),K=E("p"),K.textContent="Text",V=S(),Q=E("div"),Q.innerHTML='<label class="choose-file button cursor-pointer flex justify-center items-center whitespace-no-wrap text-white px-3 rounded w-24 h-8 mb-4 lg:rounded-xl lg:w-32 lg:h-12 md:rounded-lg md:w-32 md:h-10" for="pdf">Choose PDF</label>',Z=S(),tt=E("div"),tt.innerHTML='<hr class="line-break-2 w-full"/> \n        <div class="h-12 mb-4"></div>',et=S(),at&&at.c(),nt=S(),it.c(),F(a,"href","https://a1office.co/"),F(d,"placeholder","Untitled Document"),F(d,"type","text"),F(d,"class","edit-pdf-name select-none bg-transparent"),i=h.src,v=p="./edit-icon.svg",l||(l=document.createElement("a")),l.href=v,i!==l.href&&F(h,"src","./edit-icon.svg"),F(h,"alt","edit"),F(h,"class","lg:w-5 w-4"),F(u,"class","flex justify-center items-center lg:ml-32"),F(g,"class","cursor-pointer flex justify-center items-center"),F(s,"class","flex flex-row justify-around lg:justify-between content-center items-center w-full"),F(r,"class","header flex flex-row justify-around content-center items-center top-0 left-0 right-0 w-full"),F(x,"type","file"),F(x,"id","image"),F(x,"name","image"),F(x,"class","hidden"),F($,"type","file"),F($,"name","pdf"),F($,"id","pdf"),F($,"class","hidden"),F(H,"class","line-break"),F(A,"class","flex items-center justify-center h-fit w-8 cursor-pointer"),F(A,"for","image"),R(A,"cursor-not-allowed",t[4]<0),R(A,"bg-gray-500",t[4]<0),F(W,"class","cursor-pointer"),F(O,"class","flex items-center justify-center h-full w-8 cursor-pointer"),R(O,"cursor-not-allowed",t[4]<0),R(O,"bg-gray-500",t[4]<0),F(Y,"class","cursor-pointer"),F(J,"class","flex items-center justify-center h-full w-8 cursor-pointer"),F(J,"for","text"),R(J,"cursor-not-allowed",t[4]<0),R(J,"bg-gray-500",t[4]<0),F(K,"class","cursor-pointer"),F(P,"class","flex flex-row w-full justify-evenly items-center mt-10"),F(tt,"class","hide hidden w-full justify-center items-center flex flex-col"),F(j,"class","tools flex flex-col justify-center items-center h-full w-screen"),F(y,"class","toolbar fixed z-10 bottom-0 left-0 right-0 flex justify-around items-center bg-white"),F(o,"class","App flex flex-col items-center min-h-screen")},m(i,l){vt(e,i,l),L(i,n,l),L(i,o,l),v(o,r),v(r,s),v(s,a),v(s,c),v(s,u),v(u,d),_(d,t[0]),v(u,f),v(u,h),v(s,m),v(s,g),v(o,w),v(o,y),v(y,x),v(y,b),v(y,$),v(y,z),v(y,j),v(j,H),v(j,T),v(j,P),v(P,D),v(D,A),v(D,N),v(D,W),v(P,q),v(P,B),v(B,O),v(B,X),v(B,Y),v(P,U),v(P,I),v(I,J),v(I,G),v(I,K),v(P,V),v(P,Q),v(j,Z),v(j,tt),v(o,et),at&&at.m(o,null),v(o,nt),pt[ot].m(o,null),rt=!0,st||(lt=[C(de,"dragenter",M(t[17])),C(de,"dragover",M(t[18])),C(de,"drop",M(t[6])),C(d,"input",t[19]),C(g,"click",t[15]),C(x,"change",t[7]),C($,"change",t[6]),C(B,"click",t[8]),C(I,"click",t[16])],st=!0)},p(t,e){1&e[0]&&d.value!==t[0]&&_(d,t[0]),16&e[0]&&R(A,"cursor-not-allowed",t[4]<0),16&e[0]&&R(A,"bg-gray-500",t[4]<0),16&e[0]&&R(O,"cursor-not-allowed",t[4]<0),16&e[0]&&R(O,"bg-gray-500",t[4]<0),16&e[0]&&R(J,"cursor-not-allowed",t[4]<0),16&e[0]&&R(J,"bg-gray-500",t[4]<0),t[5]?at?(at.p(t,e),32&e[0]&&ft(at,1)):(at=pe(t),at.c(),ft(at,1),at.m(o,nt)):at&&(ut(),ht(at,1,1,()=>{at=null}),dt());let n=ot;ot=mt(t),ot===n?pt[ot].p(t,e):(ut(),ht(pt[n],1,1,()=>{pt[n]=null}),dt(),it=pt[ot],it?it.p(t,e):(it=pt[ot]=ct[ot](t),it.c()),ft(it,1),it.m(o,null))},i(t){rt||(ft(e.$$.fragment,t),ft(at),ft(it),rt=!0)},o(t){ht(e.$$.fragment,t),ht(at),ht(it),rt=!1},d(t){bt(e,t),t&&k(n),t&&k(o),at&&at.d(),pt[ot].d(),st=!1,i(lt)}}}function Le(t,e,n){const o=function(){let t=0;return function(){return t++}}();let i,r=!1,s="",l=[],a=[],c=[],u="Times-Roman",d=-1,f=!1,h=!1;async function p(t){try{const e=await async function(t){const e=await Ut("pdfjsLib"),n=new Blob([t]),o=window.URL.createObjectURL(n);return e.getDocument(o).promise}(t);n(0,s=t.name),i=t;const o=e.numPages;n(1,l=Array(o).fill().map((t,n)=>e.getPage(n+1))),n(3,c=l.map(()=>[])),n(2,a=Array(o).fill(1))}catch(t){throw console.log("Failed to add pdf."),t}}function m(t,e,i,r=1){const s={id:o(),path:i,type:"drawing",x:0,y:0,originWidth:t,originHeight:e,width:t*r,scale:r};n(3,c=c.map((t,e)=>e===d?[...t,s]:t))}function g(t){n(4,d=t)}function w(t,e){n(3,c=c.map((n,o)=>o==d?n.map(n=>n.id===t?{...n,...e}:n):n))}function y(t){n(3,c=c.map((e,n)=>n==d?e.filter(e=>e.id!==t):e))}function x(t,e){n(2,a[e]=t,a)}window.onbeforeunload=()=>{if(r)return""},U(async()=>{try{const t=await fetch("test.pdf"),e=await t.blob();await p(e),n(4,d=0),setTimeout(()=>{Kt(u),Xt.forEach(It)},5e3)}catch(t){console.log(t)}});return[s,l,a,c,d,h,async function(t){const e=(t.target.files||t.dataTransfer&&t.dataTransfer.files)[0];if(e&&"application/pdf"===e.type){n(4,d=-1);try{await p(e),r=!0,console.log("Upload PDF Fired!"),n(4,d=0)}catch(t){console.log(t)}}},async function(t){const e=t.target.files[0];e&&d>=0&&(!async function(t){try{const i=await function(t){return new Promise((e,n)=>{const o=new FileReader;o.onload=()=>e(o.result),o.onerror=n,o.readAsDataURL(t)})}(t),r=await(e=i,new Promise((t,n)=>{const o=new Image;if(o.onload=()=>t(o),o.onerror=n,e instanceof Blob){const t=window.URL.createObjectURL(e);o.src=t}else o.src=e})),s=o(),{width:l,height:a}=r,u={id:s,type:"image",width:l,height:a,x:0,y:0,payload:r,file:t};n(3,c=c.map((t,e)=>e===d?[...t,u]:t))}catch(t){console.log("Fail to add image.",t)}var e}(e),r=!0),t.target.value=null},function(){d>=0&&(n(5,h=!0),r=!0)},m,function(t){const e=t.detail.name;Kt(e),u=e},g,w,y,x,async function(){if(i&&!f&&l.length){f=!0;try{await async function(t,e,n){const o=await Ut("PDFLib"),i=await Ut("download"),r=await Ut("makeTextPDF");let s;try{s=await o.PDFDocument.load(await ue(t))}catch(t){throw console.log("Failed to load PDF."),t}const l=s.getPages().map(async(t,n)=>{const i=e[n],l=t.getHeight(),a=i.map(async e=>{if("image"===e.type){let n,{file:o,x:i,y:r,width:a,height:c}=e;try{return n="image/jpeg"===o.type?await s.embedJpg(await ue(o)):await s.embedPng(await ue(o)),()=>t.drawImage(n,{x:i,y:l-r-c,width:a,height:c})}catch(t){return console.log("Failed to embed image.",t),Ot}}else{if("text"===e.type){let{x:n,y:o,lines:i,lineHeight:a,size:c,fontFamily:u,width:d}=e;const f=c*a*i.length,h=await Kt(u),[p]=await s.embedPdf(await r({lines:i,fontSize:c,lineHeight:a,width:d,height:f,font:h.buffer||u,dy:h.correction(c,a)}));return()=>t.drawPage(p,{width:d,height:f,x:n,y:l-o-f})}if("drawing"===e.type){let{x:n,y:i,path:r,scale:s}=e;const{pushGraphicsState:a,setLineCap:c,popGraphicsState:u,setLineJoin:d,LineCapStyle:f,LineJoinStyle:h}=o;return()=>{t.pushOperators(a(),c(f.Round),d(h.Round)),t.drawSvgPath(r,{borderWidth:5,scale:s,x:n,y:l-i}),t.pushOperators(u())}}}});(await Promise.all(a)).forEach(t=>t())});await Promise.all(l);try{i(await s.save(),n,"application/pdf")}catch(t){throw console.log("Failed to save PDF."),t}}(i,c,s)}catch(t){console.log(t)}finally{f=!1}}},function(t){const e=document.querySelector(".toolbar"),i=document.querySelector(".hide"),s=document.querySelector(".tools");e.classList.contains("toolbar--expand")?(e.classList.remove("toolbar--expand"),i.classList.add("hidden"),s.classList.remove("justify-around"),s.classList.add("justify-center")):(e.classList.add("toolbar--expand"),i.classList.remove("hidden"),s.classList.add("justify-around"),s.classList.remove("justify-center"),function(t="New Text Field"){const e=o();Kt(u);const i={id:e,text:t,type:"text",size:16,width:0,lineHeight:1.4,fontFamily:u,x:0,y:0};n(3,c=c.map((t,e)=>e===d?[...t,i]:t)),console.log("Add text field fired!"),r=!0}())},function(e){J.call(this,t,e)},function(e){J.call(this,t,e)},function(){s=this.value,n(0,s)},t=>{const{originWidth:e,originHeight:o,path:i}=t.detail;let r=1;e>500&&(r=500/e),m(e,o,i,r),n(5,h=!1)},()=>n(5,h=!1),(t,e)=>x(e.detail.scale,t),(t,e)=>w(t.id,e.detail),t=>y(t.id),(t,e)=>w(t.id,e.detail),t=>y(t.id),(t,e)=>w(t.id,e.detail),t=>y(t.id),t=>g(t),t=>g(t)]}Ut("pdfjsLib");return new class extends kt{constructor(t){super(),Lt(this,t,Le,$e,s,{},null,[-1,-1])}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
